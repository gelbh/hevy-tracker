<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Routine Created Successfully</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
      };
    </script>
    <?!= HtmlService.createHtmlOutputFromFile('ui/dialogs/shared-theme').getContent() ?>
  </head>
  <body
    class="bg-[hsl(var(--background))] text-[hsl(var(--foreground))] fade-in"
    role="dialog"
    aria-labelledby="dialog-title"
    aria-describedby="dialog-description"
  >
    <main class="p-8 text-center max-w-md mx-auto">
      <header class="flex flex-col items-center gap-4 mb-6 scale-in">
        <div
          class="w-20 h-20 rounded-full bg-[hsl(var(--success)/0.1)] flex items-center justify-center"
          aria-hidden="true"
        >
          <i
            data-lucide="check-circle-2"
            class="icon icon-xl text-[hsl(var(--success))]"
          ></i>
        </div>
        <h1 id="dialog-title" class="heading-2 m-0 text-[hsl(var(--success))]">
          Routine Created
        </h1>
        <p
          id="dialog-description"
          class="text-sm text-[hsl(var(--muted-foreground))]"
        >
          Your routine has been successfully created!
        </p>
      </header>

      <section class="mb-6" aria-label="Action links">
        <a
          href="https://hevy.com/routines"
          target="_blank"
          rel="noopener noreferrer"
          class="btn btn-primary inline-flex items-center gap-2"
          aria-label="View routine on Hevy in a new tab"
        >
          <i
            data-lucide="external-link"
            class="icon icon-sm"
            aria-hidden="true"
          ></i>
          View Routine on Hevy
        </a>
      </section>

      <nav class="flex justify-center gap-3 mt-6" aria-label="Dialog actions">
        <button
          type="button"
          id="clearFormBtn"
          class="btn btn-primary"
          aria-label="Clear routine builder form"
        >
          <i data-lucide="trash-2" class="icon icon-sm" aria-hidden="true"></i>
          Clear Form
        </button>
        <button
          type="button"
          id="closeBtn"
          class="btn btn-secondary"
          aria-label="Close dialog"
        >
          <i data-lucide="x" class="icon icon-sm" aria-hidden="true"></i>
          Close
        </button>
      </nav>
    </main>

    <script>
      // Initialize icons using shared utility
      if (
        typeof window.HevyTrackerUtils !== "undefined" &&
        window.HevyTrackerUtils.initIcons
      ) {
        window.HevyTrackerUtils.initIcons();
      }

      // Initialize button handlers
      document.addEventListener("DOMContentLoaded", function () {
        const clearFormBtn = document.getElementById("clearFormBtn");
        const closeBtn = document.getElementById("closeBtn");

        if (clearFormBtn) {
          clearFormBtn.addEventListener("click", function () {
            if (
              typeof google !== "undefined" &&
              google.script &&
              google.script.run
            ) {
              google.script.run
                .withSuccessHandler(function () {
                  if (google.script.host) {
                    google.script.host.close();
                  }
                })
                .clearRoutineBuilder();
            }
          });
        }

        if (closeBtn) {
          closeBtn.addEventListener("click", function () {
            if (
              typeof google !== "undefined" &&
              google.script &&
              google.script.host
            ) {
              google.script.host.close();
            }
          });
        }

        // Re-initialize icons after DOM is ready
        if (
          typeof window.HevyTrackerUtils !== "undefined" &&
          window.HevyTrackerUtils.initIcons
        ) {
          window.HevyTrackerUtils.initIcons();
        }
      });
    </script>
  </body>
</html>
