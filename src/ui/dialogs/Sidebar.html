<!DOCTYPE html>
<html lang="en" xml:lang="en">
  <head>
    <title>Sidebar</title>
    <base target="_top" />
    <link
      rel="stylesheet"
      href="https://ssl.gstatic.com/docs/script/css/add-ons1.css"
    />
    <!-- Add-on-specific CSS -->
    <style>
      .sidebar {
        padding: 10px;
      }
      .section {
        margin-bottom: 20px;
      }
      .section-title {
        color: #666;
        font-size: 13px;
        font-weight: 500;
        margin-bottom: 10px;
        text-transform: uppercase;
      }
      .button-container {
        margin-bottom: 15px;
      }
      .sidebar-button {
        width: 100%;
        margin-bottom: 8px;
        text-align: left;
      }
      .divider {
        border-top: 1px solid #e0e0e0;
        margin: 15px 0;
      }
    </style>
  </head>
  <body>
    <div class="sidebar">
      <? if (data.isTemplate) { ?>
      <div class="button-container">
        <button
          class="action"
          onclick="runAction('showCreateSpreadsheetDialog')"
        >
          ğŸ“‹ Create New Spreadsheet From Template
        </button>
      </div>

      <div class="divider"></div>

      <div class="button-container">
        <button class="action" onclick="runAction('importAllExercises')">
          ğŸ’ª Import Exercises
        </button>
      </div>

      <div class="divider"></div>

      <div class="button-container">
        <button class="share" onclick="runAction('showGuideDialog')">
          â“ View Setup Guide
        </button>
      </div>

      <? } else { ?>
      <div class="button-container">
        <button class="blue" onclick="runAction('showInitialSetup')">
          ğŸ”‘ Set Hevy API Key
        </button>
      </div>

      <div class="divider"></div>

      <div class="section">
        <div class="section-title">Import Data</div>
        <div class="button-container">
          <button
            class="action sidebar-button"
            onclick="runAction('runInitialImport')"
          >
            ğŸ“¥ Import All
          </button>
          <button
            class="action sidebar-button"
            onclick="runAction('importAllWorkouts')"
          >
            ğŸ‹ï¸ Import Workouts
          </button>
          <button
            class="action sidebar-button"
            onclick="runAction('importAllExercises')"
          >
            ğŸ’ª Import Exercises
          </button>
          <button
            class="action sidebar-button"
            onclick="runAction('importAllRoutines')"
          >
            ğŸ“‹ Import Routines
          </button>
          <button
            class="action sidebar-button"
            onclick="runAction('importAllRoutineFolders')"
          >
            ğŸ“ Import Routine Folders
          </button>
        </div>
      </div>

      <div class="divider"></div>

      <div class="section">
        <div class="section-title">Routine Builder</div>
        <div class="button-container">
          <button
            class="action sidebar-button"
            onclick="runAction('createRoutineFromSheet')"
          >
            ğŸ“‹ Create Routine from Sheet
          </button>
          <button
            class="action sidebar-button"
            onclick="runAction('clearRoutineBuilder')"
          >
            ğŸ—‘ï¸ Clear Builder Form
          </button>
        </div>
      </div>

      <div class="divider"></div>

      <div class="button-container">
        <button class="action" onclick="runAction('logWeight')">
          âš–ï¸ Log Weight
        </button>
      </div>

      <div class="divider"></div>

      <div class="button-container">
        <button
          class="create"
          onclick="runAction('showCreateSpreadsheetDialog')"
        >
          ğŸ“‹ Create New Spreadsheet
        </button>
        <button class="share" onclick="runAction('showGuideDialog')">
          â“ View Setup Guide
        </button>
      </div>
      <? } ?>
    </div>

    <script>
      function runAction(action) {
        google.script.run
          .withSuccessHandler(handleSuccess)
          .withFailureHandler(handleError)
          .runMenuAction(action);
      }

      function handleSuccess(response) {
        if (response.message) {
          // You could add a toast/notification system here
          console.log(response.message);
        }
      }

      function handleError(error) {
        console.error(error);
        // You could add an error notification system here
      }
    </script>
  </body>
</html>
